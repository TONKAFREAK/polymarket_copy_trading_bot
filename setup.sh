#!/bin/bash

# Polymarket Copy Trading Bot - Setup Script
# This script installs all dependencies and builds the project

set -e

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   Polymarket Copy Trading Bot - Setup                         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Check if Node.js is installed
if ! command -v node &> /dev/null; then
    echo "âŒ Node.js is not installed. Please install Node.js 18+ from https://nodejs.org"
    exit 1
fi

echo "âœ“ Node.js version: $(node --version)"
echo "âœ“ npm version: $(npm --version)"
echo ""

# Install root dependencies
echo "ğŸ“¦ Installing root dependencies..."
npm install
echo "âœ“ Root dependencies installed"
echo ""

# Install client dependencies
echo "ğŸ“¦ Installing client dependencies..."
cd client
npm install
cd ..
echo "âœ“ Client dependencies installed"
echo ""

# Build root project
echo "ğŸ”¨ Building root project (TypeScript)..."
npm run build
echo "âœ“ Root project built"
echo ""

# Build client
echo "ğŸ”¨ Building client (Next.js + Electron)..."
cd client
npm run build
cd ..
echo "âœ“ Client built"
echo ""

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   âœ“ Setup Complete!                                           â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "Next steps:"
echo "  1. Copy .env.example to .env and fill in your API keys"
echo "  2. Run 'npm run dev-desktop' to start the desktop app"
echo "  3. Or run 'npm run dev-cli' to use the CLI"
echo ""
